// Generated by psc version 0.6.0.2
var PS = PS || {};
PS.Prelude = (function () {
    "use strict";
    var Unit = {
        create: function (value) {
            return value;
        }
    };
    function LT() {

    };
    LT.value = new LT();
    function GT() {

    };
    GT.value = new GT();
    function EQ() {

    };
    EQ.value = new EQ();
    function Semigroupoid($less$less$less) {
        this["<<<"] = $less$less$less;
    };
    function Category(__superclass_Prelude$dotSemigroupoid_0, id) {
        this["__superclass_Prelude.Semigroupoid_0"] = __superclass_Prelude$dotSemigroupoid_0;
        this.id = id;
    };
    function Show(show) {
        this.show = show;
    };
    function Functor($less$dollar$greater) {
        this["<$>"] = $less$dollar$greater;
    };
    function Apply($less$times$greater, __superclass_Prelude$dotFunctor_0) {
        this["<*>"] = $less$times$greater;
        this["__superclass_Prelude.Functor_0"] = __superclass_Prelude$dotFunctor_0;
    };
    function Applicative(__superclass_Prelude$dotApply_0, pure) {
        this["__superclass_Prelude.Apply_0"] = __superclass_Prelude$dotApply_0;
        this.pure = pure;
    };
    function Bind($greater$greater$eq, __superclass_Prelude$dotApply_0) {
        this[">>="] = $greater$greater$eq;
        this["__superclass_Prelude.Apply_0"] = __superclass_Prelude$dotApply_0;
    };
    function Monad(__superclass_Prelude$dotApplicative_0, __superclass_Prelude$dotBind_1) {
        this["__superclass_Prelude.Applicative_0"] = __superclass_Prelude$dotApplicative_0;
        this["__superclass_Prelude.Bind_1"] = __superclass_Prelude$dotBind_1;
    };
    function Num($percent, $times, $plus, $minus, $div, negate) {
        this["%"] = $percent;
        this["*"] = $times;
        this["+"] = $plus;
        this["-"] = $minus;
        this["/"] = $div;
        this.negate = negate;
    };
    function Eq($div$eq, $eq$eq) {
        this["/="] = $div$eq;
        this["=="] = $eq$eq;
    };
    function Ord(__superclass_Prelude$dotEq_0, compare) {
        this["__superclass_Prelude.Eq_0"] = __superclass_Prelude$dotEq_0;
        this.compare = compare;
    };
    function BoolLike($amp$amp, not, $bar$bar) {
        this["&&"] = $amp$amp;
        this.not = not;
        this["||"] = $bar$bar;
    };
    function Semigroup($less$greater) {
        this["<>"] = $less$greater;
    };
    function cons(e) {  return function(l) {    return [e].concat(l);  };};
    function showStringImpl(s) {  return JSON.stringify(s);};
    function showNumberImpl(n) {  return n.toString();};
    function numAdd(n1) {  return function(n2) {    return n1 + n2;  };};
    function numSub(n1) {  return function(n2) {    return n1 - n2;  };};
    function numMul(n1) {  return function(n2) {    return n1 * n2;  };};
    function numDiv(n1) {  return function(n2) {    return n1 / n2;  };};
    function numMod(n1) {  return function(n2) {    return n1 % n2;  };};
    function numNegate(n) {  return -n;};
    function refEq(r1) {  return function(r2) {    return r1 === r2;  };};
    function refIneq(r1) {  return function(r2) {    return r1 !== r2;  };};
    function unsafeCompareImpl(lt) {  return function(eq) {    return function(gt) {      return function(x) {        return function(y) {          return x < y ? lt : x > y ? gt : eq;        };      };    };  };};
    function boolAnd(b1) {  return function(b2) {    return b1 && b2;  };};
    function boolOr(b1) {  return function(b2) {    return b1 || b2;  };};
    function boolNot(b) {  return !b;};
    function concatString(s1) {  return function(s2) {    return s1 + s2;  };};
    var $bar$bar = function (dict) {
        return dict["||"];
    };
    var $greater$greater$eq = function (dict) {
        return dict[">>="];
    };
    var $eq$eq = function (dict) {
        return dict["=="];
    };
    var $less$greater = function (dict) {
        return dict["<>"];
    };
    var $less$less$less = function (dict) {
        return dict["<<<"];
    };
    var $less$times$greater = function (dict) {
        return dict["<*>"];
    };
    var $less$dollar$greater = function (dict) {
        return dict["<$>"];
    };
    var $colon = cons;
    var $div$eq = function (dict) {
        return dict["/="];
    };
    var $minus = function (dict) {
        return dict["-"];
    };
    var $plus$plus = function (__dict_Semigroup_1) {
        return $less$greater(__dict_Semigroup_1);
    };
    var $plus = function (dict) {
        return dict["+"];
    };
    var $dollar = function (f) {
        return function (x) {
            return f(x);
        };
    };
    var unsafeCompare = unsafeCompareImpl(LT.value)(EQ.value)(GT.value);
    var unit = {};
    var showString = new Show(showStringImpl);
    var showNumber = new Show(showNumberImpl);
    var show = function (dict) {
        return dict.show;
    };
    var semigroupoidArr = new Semigroupoid(function (f) {
        return function (g) {
            return function (x) {
                return f(g(x));
            };
        };
    });
    var semigroupString = new Semigroup(concatString);
    var pure = function (dict) {
        return dict.pure;
    };
    var $$return = function (__dict_Monad_4) {
        return pure(__dict_Monad_4["__superclass_Prelude.Applicative_0"]());
    };
    var numNumber = new Num(numMod, numMul, numAdd, numSub, numDiv, numNegate);
    var not = function (dict) {
        return dict.not;
    };
    var liftA1 = function (__dict_Applicative_6) {
        return function (f) {
            return function (a) {
                return $less$times$greater(__dict_Applicative_6["__superclass_Prelude.Apply_0"]())(pure(__dict_Applicative_6)(f))(a);
            };
        };
    };
    var id = function (dict) {
        return dict.id;
    };
    var flip = function (f) {
        return function (b) {
            return function (a) {
                return f(a)(b);
            };
        };
    };
    var eqString = new Eq(refIneq, refEq);
    var eqNumber = new Eq(refIneq, refEq);
    var ordNumber = new Ord(function () {
        return eqNumber;
    }, unsafeCompare);
    var $$const = function (_94) {
        return function (_95) {
            return _94;
        };
    };
    var $$void = function (__dict_Functor_8) {
        return function (fa) {
            return $less$dollar$greater(__dict_Functor_8)($$const(unit))(fa);
        };
    };
    var compare = function (dict) {
        return dict.compare;
    };
    var $greater = function (__dict_Ord_12) {
        return function (a1) {
            return function (a2) {
                var _458 = compare(__dict_Ord_12)(a1)(a2);
                if (_458 instanceof GT) {
                    return true;
                };
                return false;
            };
        };
    };
    var categoryArr = new Category(function () {
        return semigroupoidArr;
    }, function (x) {
        return x;
    });
    var boolLikeBoolean = new BoolLike(boolAnd, boolNot, boolOr);
    var ap = function (__dict_Monad_14) {
        return function (f) {
            return function (a) {
                return $greater$greater$eq(__dict_Monad_14["__superclass_Prelude.Bind_1"]())(f)(function (_2) {
                    return $greater$greater$eq(__dict_Monad_14["__superclass_Prelude.Bind_1"]())(a)(function (_1) {
                        return $$return(__dict_Monad_14)(_2(_1));
                    });
                });
            };
        };
    };
    return {
        "$": $dollar, 
        "+": $plus, 
        "++": $plus$plus, 
        "-": $minus, 
        "/=": $div$eq, 
        ":": $colon, 
        "<$>": $less$dollar$greater, 
        "<*>": $less$times$greater, 
        "<<<": $less$less$less, 
        "<>": $less$greater, 
        "==": $eq$eq, 
        ">": $greater, 
        ">>=": $greater$greater$eq, 
        Applicative: Applicative, 
        Apply: Apply, 
        Bind: Bind, 
        BoolLike: BoolLike, 
        Category: Category, 
        EQ: EQ, 
        Eq: Eq, 
        Functor: Functor, 
        GT: GT, 
        LT: LT, 
        Monad: Monad, 
        Num: Num, 
        Ord: Ord, 
        Semigroup: Semigroup, 
        Semigroupoid: Semigroupoid, 
        Show: Show, 
        Unit: Unit, 
        ap: ap, 
        boolLikeBoolean: boolLikeBoolean, 
        categoryArr: categoryArr, 
        compare: compare, 
        cons: cons, 
        "const": $$const, 
        eqNumber: eqNumber, 
        eqString: eqString, 
        flip: flip, 
        id: id, 
        liftA1: liftA1, 
        not: not, 
        numNumber: numNumber, 
        ordNumber: ordNumber, 
        pure: pure, 
        refEq: refEq, 
        refIneq: refIneq, 
        "return": $$return, 
        semigroupString: semigroupString, 
        semigroupoidArr: semigroupoidArr, 
        show: show, 
        showNumber: showNumber, 
        showString: showString, 
        unit: unit, 
        "void": $$void, 
        "||": $bar$bar
    };
})();
var PS = PS || {};
PS.Prelude_Unsafe = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    function unsafeIndex(xs) {  return function(n) {    return xs[n];  };};
    return {
        unsafeIndex: unsafeIndex
    };
})();
var PS = PS || {};
PS.Kanren_Var = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Var = {
        create: function (value) {
            return value;
        }
    };
    var zero = 0;
    var runVar = function (_115) {
        return _115;
    };
    var eqVar = new Prelude.Eq(function (_119) {
        return function (_120) {
            return _119 !== _120;
        };
    }, function (_117) {
        return function (_118) {
            return _117 === _118;
        };
    });
    var ordVar = new Prelude.Ord(function () {
        return eqVar;
    }, function (_121) {
        return function (_122) {
            return Prelude.compare(Prelude.ordNumber)(_121)(_122);
        };
    });
    return {
        Var: Var, 
        eqVar: eqVar, 
        ordVar: ordVar, 
        runVar: runVar, 
        zero: zero
    };
})();
var PS = PS || {};
PS.Kanren_Obj = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Obj = {
        create: function (value) {
            return value;
        }
    };
    var eqObj = new Prelude.Eq(function (_126) {
        return function (_127) {
            return _126 !== _127;
        };
    }, function (_124) {
        return function (_125) {
            return _124 === _125;
        };
    });
    return {
        Obj: Obj, 
        eqObj: eqObj
    };
})();
var PS = PS || {};
PS.Kanren_Term = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Kanren_Obj = PS.Kanren_Obj;
    function TmVar(value0) {
        this.value0 = value0;
    };
    TmVar.create = function (value0) {
        return new TmVar(value0);
    };
    function TmObj(value0) {
        this.value0 = value0;
    };
    TmObj.create = function (value0) {
        return new TmObj(value0);
    };
    function TmPair(value0, value1) {
        this.value0 = value0;
        this.value1 = value1;
    };
    TmPair.create = function (value0) {
        return function (value1) {
            return new TmPair(value0, value1);
        };
    };
    var obj = function (nm) {
        return new TmObj(nm);
    };
    return {
        TmObj: TmObj, 
        TmPair: TmPair, 
        TmVar: TmVar, 
        obj: obj
    };
})();
var PS = PS || {};
PS.Data_Function = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    function runFn4(fn) {  return function(a) {    return function(b) {      return function(c) {        return function(d) {          return fn(a, b, c, d);        };      };    };  };};
    var on = function (f) {
        return function (g) {
            return function (x) {
                return function (y) {
                    return f(g(x))(g(y));
                };
            };
        };
    };
    return {
        on: on, 
        runFn4: runFn4
    };
})();
var PS = PS || {};
PS.Data_Char = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var charString = function (_135) {
        return _135;
    };
    return {
        charString: charString
    };
})();
var PS = PS || {};
PS.Control_Monad_Error = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    function Error(noMsg, strMsg) {
        this.noMsg = noMsg;
        this.strMsg = strMsg;
    };
    var strMsg = function (dict) {
        return dict.strMsg;
    };
    return {
        Error: Error, 
        strMsg: strMsg
    };
})();
var PS = PS || {};
PS.Control_Monad_Eff = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    function returnE(a) {  return function() {    return a;  };};
    function bindE(a) {  return function(f) {    return function() {      return f(a())();    };  };};
    var monadEff = new Prelude.Monad(function () {
        return applicativeEff;
    }, function () {
        return bindEff;
    });
    var bindEff = new Prelude.Bind(bindE, function () {
        return applyEff;
    });
    var applyEff = new Prelude.Apply(Prelude.ap(monadEff), function () {
        return functorEff;
    });
    var applicativeEff = new Prelude.Applicative(function () {
        return applyEff;
    }, returnE);
    var functorEff = new Prelude.Functor(Prelude.liftA1(applicativeEff));
    return {
        applicativeEff: applicativeEff, 
        applyEff: applyEff, 
        bindE: bindE, 
        bindEff: bindEff, 
        functorEff: functorEff, 
        monadEff: monadEff, 
        returnE: returnE
    };
})();
var PS = PS || {};
PS.Control_Monad_Eff_Ref = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    function newRef(val) {  return function () {    return { value: val };  };};
    function readRef(ref) {  return function() {    return ref.value;  };};
    function modifyRef(ref) {  return function(f) {    return function() {      ref.value = f(ref.value);      return {};    };  };};
    function writeRef(ref) {  return function(val) {    return function() {      ref.value = val;      return {};    };  };};
    return {
        modifyRef: modifyRef, 
        newRef: newRef, 
        readRef: readRef, 
        writeRef: writeRef
    };
})();
var PS = PS || {};
PS.Control_Lazy = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    function Lazy1(defer1) {
        this.defer1 = defer1;
    };
    var defer1 = function (dict) {
        return dict.defer1;
    };
    var fix1 = function (__dict_Lazy1_29) {
        return function (f) {
            return defer1(__dict_Lazy1_29)(function (_) {
                return f(fix1(__dict_Lazy1_29)(f));
            });
        };
    };
    return {
        Lazy1: Lazy1, 
        defer1: defer1, 
        fix1: fix1
    };
})();
var PS = PS || {};
PS.Control_Monad_Identity = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Identity = {
        create: function (value) {
            return value;
        }
    };
    var runIdentity = function (_152) {
        return _152;
    };
    var functorIdentity = new Prelude.Functor(function (f) {
        return function (m) {
            return Identity.create(f(runIdentity(m)));
        };
    });
    var applyIdentity = new Prelude.Apply(function (_153) {
        return function (_154) {
            return Identity.create(_153(_154));
        };
    }, function () {
        return functorIdentity;
    });
    var bindIdentity = new Prelude.Bind(function (m) {
        return function (f) {
            return f(runIdentity(m));
        };
    }, function () {
        return applyIdentity;
    });
    var applicativeIdentity = new Prelude.Applicative(function () {
        return applyIdentity;
    }, Identity.create);
    var monadIdentity = new Prelude.Monad(function () {
        return applicativeIdentity;
    }, function () {
        return bindIdentity;
    });
    return {
        Identity: Identity, 
        applicativeIdentity: applicativeIdentity, 
        applyIdentity: applyIdentity, 
        bindIdentity: bindIdentity, 
        functorIdentity: functorIdentity, 
        monadIdentity: monadIdentity, 
        runIdentity: runIdentity
    };
})();
var PS = PS || {};
PS.Control_Apply = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var $less$times = function (__dict_Apply_41) {
        return function (a) {
            return function (b) {
                return Prelude["<*>"](__dict_Apply_41)(Prelude["<$>"](__dict_Apply_41["__superclass_Prelude.Functor_0"]())(Prelude["const"])(a))(b);
            };
        };
    };
    var $times$greater = function (__dict_Apply_42) {
        return function (a) {
            return function (b) {
                return Prelude["<*>"](__dict_Apply_42)(Prelude["<$>"](__dict_Apply_42["__superclass_Prelude.Functor_0"]())(Prelude["const"](Prelude.id(Prelude.categoryArr)))(a))(b);
            };
        };
    };
    return {
        "*>": $times$greater, 
        "<*": $less$times
    };
})();
var PS = PS || {};
PS.Control_Alt = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    function Alt($less$bar$greater, __superclass_Prelude$dotFunctor_0) {
        this["<|>"] = $less$bar$greater;
        this["__superclass_Prelude.Functor_0"] = __superclass_Prelude$dotFunctor_0;
    };
    var $less$bar$greater = function (dict) {
        return dict["<|>"];
    };
    return {
        "<|>": $less$bar$greater, 
        Alt: Alt
    };
})();
var PS = PS || {};
PS.Control_Plus = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    function Plus(__superclass_Control$dotAlt$dotAlt_0, empty) {
        this["__superclass_Control.Alt.Alt_0"] = __superclass_Control$dotAlt$dotAlt_0;
        this.empty = empty;
    };
    return {
        Plus: Plus
    };
})();
var PS = PS || {};
PS.Control_Alternative = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Control_Lazy = PS.Control_Lazy;
    var Control_Alt = PS.Control_Alt;
    function Alternative(__superclass_Control$dotPlus$dotPlus_1, __superclass_Prelude$dotApplicative_0) {
        this["__superclass_Control.Plus.Plus_1"] = __superclass_Control$dotPlus$dotPlus_1;
        this["__superclass_Prelude.Applicative_0"] = __superclass_Prelude$dotApplicative_0;
    };
    var some = function (__dict_Alternative_48) {
        return function (__dict_Lazy1_49) {
            return function (v) {
                return Prelude["<*>"]((__dict_Alternative_48["__superclass_Prelude.Applicative_0"]())["__superclass_Prelude.Apply_0"]())(Prelude["<$>"](((__dict_Alternative_48["__superclass_Control.Plus.Plus_1"]())["__superclass_Control.Alt.Alt_0"]())["__superclass_Prelude.Functor_0"]())(Prelude[":"])(v))(Control_Lazy.defer1(__dict_Lazy1_49)(function (_) {
                    return many(__dict_Alternative_48)(__dict_Lazy1_49)(v);
                }));
            };
        };
    };
    var many = function (__dict_Alternative_50) {
        return function (__dict_Lazy1_51) {
            return function (v) {
                return Control_Alt["<|>"]((__dict_Alternative_50["__superclass_Control.Plus.Plus_1"]())["__superclass_Control.Alt.Alt_0"]())(some(__dict_Alternative_50)(__dict_Lazy1_51)(v))(Prelude.pure(__dict_Alternative_50["__superclass_Prelude.Applicative_0"]())([  ]));
            };
        };
    };
    return {
        Alternative: Alternative, 
        many: many, 
        some: some
    };
})();
var PS = PS || {};
PS.Data_Either = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    function Left(value0) {
        this.value0 = value0;
    };
    Left.create = function (value0) {
        return new Left(value0);
    };
    function Right(value0) {
        this.value0 = value0;
    };
    Right.create = function (value0) {
        return new Right(value0);
    };
    var functorEither = new Prelude.Functor(function (_161) {
        return function (_162) {
            if (_162 instanceof Left) {
                return new Left(_162.value0);
            };
            if (_162 instanceof Right) {
                return new Right(_161(_162.value0));
            };
            throw new Error("Failed pattern match");
        };
    });
    var applyEither = new Prelude.Apply(function (_163) {
        return function (_164) {
            if (_163 instanceof Left) {
                return new Left(_163.value0);
            };
            if (_163 instanceof Right) {
                return Prelude["<$>"](functorEither)(_163.value0)(_164);
            };
            throw new Error("Failed pattern match");
        };
    }, function () {
        return functorEither;
    });
    var applicativeEither = new Prelude.Applicative(function () {
        return applyEither;
    }, Right.create);
    return {
        Left: Left, 
        Right: Right, 
        applicativeEither: applicativeEither, 
        applyEither: applyEither, 
        functorEither: functorEither
    };
})();
var PS = PS || {};
PS.Data_Maybe = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    function Nothing() {

    };
    Nothing.value = new Nothing();
    function Just(value0) {
        this.value0 = value0;
    };
    Just.create = function (value0) {
        return new Just(value0);
    };
    var maybe = function (_172) {
        return function (_173) {
            return function (_174) {
                if (_174 instanceof Nothing) {
                    return _172;
                };
                if (_174 instanceof Just) {
                    return _173(_174.value0);
                };
                throw new Error("Failed pattern match");
            };
        };
    };
    var fromMaybe = function (a) {
        return maybe(a)(Prelude.id(Prelude.categoryArr));
    };
    return {
        Just: Just, 
        Nothing: Nothing, 
        fromMaybe: fromMaybe, 
        maybe: maybe
    };
})();
var PS = PS || {};
PS.Data_Array = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Data_Maybe = PS.Data_Maybe;
    function length (xs) {  return xs.length;};
    function append (l1) {  return function (l2) {    return l1.concat(l2);  };};
    function slice (s) {  return function (e) {    return function (l) {      return l.slice(s, e);    };  };};
    function map (f) {  return function (arr) {    var l = arr.length;    var result = new Array(l);    for (var i = 0; i < l; i++) {      result[i] = f(arr[i]);    }    return result;  };};
    function range (start) {  return function (end) {    var i = ~~start, e = ~~end;    var step = i > e ? -1 : 1;    var result = [i], n = 1;    while (i !== e) {      i += step;      result[n++] = i;    }    return result;  };};
    function zipWith (f) {  return function (xs) {    return function (ys) {      var l = xs.length < ys.length ? xs.length : ys.length;      var result = new Array(l);      for (var i = 0; i < l; i++) {        result[i] = f(xs[i])(ys[i]);      }      return result;    };  };};
    function sortJS (f) {  return function (l) {    return l.slice().sort(function (x, y) {      return f(x)(y);    });  };};
    var $dot$dot = range;
    var sortBy = function (comp) {
        return function (xs) {
            var comp$prime = function (x) {
                return function (y) {
                    var _488 = comp(x)(y);
                    if (_488 instanceof Prelude.GT) {
                        return 1;
                    };
                    if (_488 instanceof Prelude.EQ) {
                        return 0;
                    };
                    if (_488 instanceof Prelude.LT) {
                        return -1;
                    };
                    throw new Error("Failed pattern match");
                };
            };
            return sortJS(comp$prime)(xs);
        };
    };
    var semigroupArray = new Prelude.Semigroup(append);
    var $$null = function (_196) {
        if (_196.length === 0) {
            return true;
        };
        return false;
    };
    var init = function (_195) {
        if (_195.length === 0) {
            return Data_Maybe.Nothing.value;
        };
        return new Data_Maybe.Just(slice(0)(length(_195) - 1)(_195));
    };
    var functorArray = new Prelude.Functor(map);
    return {
        "..": $dot$dot, 
        append: append, 
        functorArray: functorArray, 
        init: init, 
        length: length, 
        map: map, 
        "null": $$null, 
        range: range, 
        semigroupArray: semigroupArray, 
        sortBy: sortBy, 
        zipWith: zipWith
    };
})();
var PS = PS || {};
PS.Data_Foreign = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Data_Either = PS.Data_Either;
    function TypeMismatch(value0, value1) {
        this.value0 = value0;
        this.value1 = value1;
    };
    TypeMismatch.create = function (value0) {
        return function (value1) {
            return new TypeMismatch(value0, value1);
        };
    };
    function ErrorAtIndex(value0, value1) {
        this.value0 = value0;
        this.value1 = value1;
    };
    ErrorAtIndex.create = function (value0) {
        return function (value1) {
            return new ErrorAtIndex(value0, value1);
        };
    };
    function ErrorAtProperty(value0, value1) {
        this.value0 = value0;
        this.value1 = value1;
    };
    ErrorAtProperty.create = function (value0) {
        return function (value1) {
            return new ErrorAtProperty(value0, value1);
        };
    };
    function JSONError(value0) {
        this.value0 = value0;
    };
    JSONError.create = function (value0) {
        return new JSONError(value0);
    };
    function unsafeFromForeign(value) {  return value;};
    function tagOf(value) {  return Object.prototype.toString.call(value).slice(8, -1);};
    var unsafeReadPrim = function (_213) {
        return function (_214) {
            if (tagOf(_214) === _213) {
                return Prelude.pure(Data_Either.applicativeEither)(unsafeFromForeign(_214));
            };
            return new Data_Either.Left(new TypeMismatch(_213, tagOf(_214)));
        };
    };
    var showForeignError = new Prelude.Show(function (_216) {
        if (_216 instanceof TypeMismatch) {
            return "Type mismatch: expected " + (_216.value0 + (", found " + _216.value1));
        };
        if (_216 instanceof ErrorAtIndex) {
            return "Error at array index " + (Prelude.show(Prelude.showNumber)(_216.value0) + (": " + Prelude.show(showForeignError)(_216.value1)));
        };
        if (_216 instanceof ErrorAtProperty) {
            return "Error at property " + (Prelude.show(Prelude.showString)(_216.value0) + (": " + Prelude.show(showForeignError)(_216.value1)));
        };
        if (_216 instanceof JSONError) {
            return "JSON error: " + _216.value0;
        };
        throw new Error("Failed pattern match");
    });
    var readString = unsafeReadPrim("String");
    return {
        ErrorAtIndex: ErrorAtIndex, 
        ErrorAtProperty: ErrorAtProperty, 
        JSONError: JSONError, 
        TypeMismatch: TypeMismatch, 
        readString: readString, 
        showForeignError: showForeignError, 
        tagOf: tagOf, 
        unsafeFromForeign: unsafeFromForeign
    };
})();
var PS = PS || {};
PS.Control_Monad_JQuery = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    
  function select(selector) {
    return function () {
      return jQuery(selector);
    };
  }
  ;
    
  function create(html) {
    return function () {
      return jQuery(html);
    };
  }
  ;
    
  function attr(attrs) {
    return function(ob) {
      return function () {
        return ob.attr(attrs);
      };
    };
  }
  ;
    
  function css(props) {
    return function(ob) {
      return function () {
        return ob.css(props);
      };
    };
  }
  ;
    
  function addClass(cls) {
    return function(ob) {
      return function () {
        return ob.addClass(cls);
      };
    };
  }
  ;
    
  function append(ob1) {
    return function(ob) {
      return function () {
        return ob.append(ob1);
      };
    };
  }
  ;
    
  function remove(ob) {
    return function () {
      return ob.remove();
    };
  }
  ;
    
  function appendText(s) {
    return function(ob) {
      return function () {
        return ob.append(s);
      };
    };
  }
  ;
    
  function getValue(ob) {
    return function() {
      return ob.val();
    };
  }
  ;
    
  function on(evt) {
    return function(act) {
      return function(ob) {
        return function() {
          return ob.on(evt, function(e) {
            act(e)(jQuery(this))();
          });
        };
      };
    };
  }
  ;
    
  function preventDefault(e) {
    return function() {
      e.preventDefault();
    };
  }
  ;
    return {
        addClass: addClass, 
        append: append, 
        appendText: appendText, 
        attr: attr, 
        create: create, 
        css: css, 
        getValue: getValue, 
        on: on, 
        preventDefault: preventDefault, 
        remove: remove, 
        select: select
    };
})();
var PS = PS || {};
PS.Data_Maybe_Unsafe = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Data_Maybe = PS.Data_Maybe;
    var fromJust = function (_231) {
        if (_231 instanceof Data_Maybe.Just) {
            return _231.value0;
        };
        throw new Error("Failed pattern match");
    };
    return {
        fromJust: fromJust
    };
})();
var PS = PS || {};
PS.Data_Array_Unsafe = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Prelude_Unsafe = PS.Prelude_Unsafe;
    var Data_Array = PS.Data_Array;
    var Data_Maybe_Unsafe = PS.Data_Maybe_Unsafe;
    var last = function (xs) {
        return xs[Data_Array.length(xs) - 1];
    };
    var init = Prelude["<<<"](Prelude.semigroupoidArr)(Data_Maybe_Unsafe.fromJust)(Data_Array.init);
    return {
        init: init, 
        last: last
    };
})();
var PS = PS || {};
PS.Data_Monoid = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Data_Array = PS.Data_Array;
    function Monoid(__superclass_Prelude$dotSemigroup_0, mempty) {
        this["__superclass_Prelude.Semigroup_0"] = __superclass_Prelude$dotSemigroup_0;
        this.mempty = mempty;
    };
    var monoidString = new Monoid(function () {
        return Prelude.semigroupString;
    }, "");
    var monoidArray = new Monoid(function () {
        return Data_Array.semigroupArray;
    }, [  ]);
    var mempty = function (dict) {
        return dict.mempty;
    };
    return {
        Monoid: Monoid, 
        mempty: mempty, 
        monoidArray: monoidArray, 
        monoidString: monoidString
    };
})();
var PS = PS || {};
PS.Data_Tuple = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Data_Array = PS.Data_Array;
    function Tuple(value0, value1) {
        this.value0 = value0;
        this.value1 = value1;
    };
    Tuple.create = function (value0) {
        return function (value1) {
            return new Tuple(value0, value1);
        };
    };
    var zip = Data_Array.zipWith(Tuple.create);
    var fst = function (_283) {
        return _283.value0;
    };
    return {
        Tuple: Tuple, 
        fst: fst, 
        zip: zip
    };
})();
var PS = PS || {};
PS.Data_Monoid_First = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Data_Maybe = PS.Data_Maybe;
    var Data_Monoid = PS.Data_Monoid;
    var First = {
        create: function (value) {
            return value;
        }
    };
    var semigroupFirst = new Prelude.Semigroup(function (_345) {
        return function (_346) {
            if (_345 instanceof Data_Maybe.Just) {
                return _345;
            };
            return _346;
        };
    });
    var runFirst = function (_337) {
        return _337;
    };
    var monoidFirst = new Data_Monoid.Monoid(function () {
        return semigroupFirst;
    }, Data_Maybe.Nothing.value);
    return {
        First: First, 
        monoidFirst: monoidFirst, 
        runFirst: runFirst, 
        semigroupFirst: semigroupFirst
    };
})();
var PS = PS || {};
PS.Data_Foldable = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Data_Monoid = PS.Data_Monoid;
    var Data_Monoid_First = PS.Data_Monoid_First;
    var Data_Tuple = PS.Data_Tuple;
    var Data_Maybe = PS.Data_Maybe;
    function Foldable(foldMap, foldl, foldr) {
        this.foldMap = foldMap;
        this.foldl = foldl;
        this.foldr = foldr;
    };
    function foldrArray(f) {  return function(z) {    return function(xs) {      var acc = z;      for (var i = xs.length - 1; i >= 0; --i) {        acc = f(xs[i])(acc);      }      return acc;    }  }};
    function foldlArray(f) {  return function(z) {    return function(xs) {      var acc = z;      for (var i = 0, len = xs.length; i < len; ++i) {        acc = f(acc)(xs[i]);      }      return acc;    }  }};
    var foldr = function (dict) {
        return dict.foldr;
    };
    var foldl = function (dict) {
        return dict.foldl;
    };
    var intercalate = function (__dict_Foldable_311) {
        return function (__dict_Monoid_312) {
            return function (sep) {
                return function (xs) {
                    var go = function (_380) {
                        return function (_381) {
                            if (_380.init) {
                                return {
                                    init: false, 
                                    acc: _381
                                };
                            };
                            return {
                                init: false, 
                                acc: Prelude["<>"](__dict_Monoid_312["__superclass_Prelude.Semigroup_0"]())(_380.acc)(Prelude["<>"](__dict_Monoid_312["__superclass_Prelude.Semigroup_0"]())(sep)(_381))
                            };
                        };
                    };
                    return (foldl(__dict_Foldable_311)(go)({
                        init: true, 
                        acc: Data_Monoid.mempty(__dict_Monoid_312)
                    })(xs)).acc;
                };
            };
        };
    };
    var or = function (__dict_Foldable_315) {
        return foldl(__dict_Foldable_315)(Prelude["||"](Prelude.boolLikeBoolean))(false);
    };
    var foldableArray = new Foldable(function (__dict_Monoid_322) {
        return function (f) {
            return function (xs) {
                return foldr(foldableArray)(function (x) {
                    return function (acc) {
                        return Prelude["<>"](__dict_Monoid_322["__superclass_Prelude.Semigroup_0"]())(f(x))(acc);
                    };
                })(Data_Monoid.mempty(__dict_Monoid_322))(xs);
            };
        };
    }, function (f) {
        return function (z) {
            return function (xs) {
                return foldlArray(f)(z)(xs);
            };
        };
    }, function (f) {
        return function (z) {
            return function (xs) {
                return foldrArray(f)(z)(xs);
            };
        };
    });
    var foldMap = function (dict) {
        return dict.foldMap;
    };
    var lookup = function (__dict_Eq_323) {
        return function (__dict_Foldable_324) {
            return function (a) {
                return function (f) {
                    return Data_Monoid_First.runFirst(foldMap(__dict_Foldable_324)(Data_Monoid_First.monoidFirst)(function (_347) {
                        return Prelude["=="](__dict_Eq_323)(a)(_347.value0) ? new Data_Maybe.Just(_347.value1) : Data_Maybe.Nothing.value;
                    })(f));
                };
            };
        };
    };
    var find = function (__dict_Foldable_327) {
        return function (p) {
            return function (f) {
                var _517 = foldMap(__dict_Foldable_327)(Data_Monoid.monoidArray)(function (x) {
                    return p(x) ? [ x ] : [  ];
                })(f);
                if (_517.length >= 1) {
                    var _519 = _517.slice(1);
                    return new Data_Maybe.Just(_517[0]);
                };
                if (_517.length === 0) {
                    return Data_Maybe.Nothing.value;
                };
                throw new Error("Failed pattern match");
            };
        };
    };
    var any = function (__dict_Foldable_328) {
        return function (p) {
            return Prelude["<<<"](Prelude.semigroupoidArr)(or(foldableArray))(foldMap(__dict_Foldable_328)(Data_Monoid.monoidArray)(function (x) {
                return [ p(x) ];
            }));
        };
    };
    var elem = function (__dict_Eq_329) {
        return function (__dict_Foldable_330) {
            return Prelude["<<<"](Prelude.semigroupoidArr)(any(__dict_Foldable_330))(Prelude["=="](__dict_Eq_329));
        };
    };
    var notElem = function (__dict_Eq_331) {
        return function (__dict_Foldable_332) {
            return function (x) {
                return Prelude["<<<"](Prelude.semigroupoidArr)(Prelude.not(Prelude.boolLikeBoolean))(elem(__dict_Eq_331)(__dict_Foldable_332)(x));
            };
        };
    };
    return {
        Foldable: Foldable, 
        any: any, 
        elem: elem, 
        find: find, 
        foldMap: foldMap, 
        foldableArray: foldableArray, 
        foldl: foldl, 
        foldlArray: foldlArray, 
        foldr: foldr, 
        foldrArray: foldrArray, 
        intercalate: intercalate, 
        lookup: lookup, 
        notElem: notElem, 
        or: or
    };
})();
var PS = PS || {};
PS.Kanren_Goal = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    function Done() {

    };
    Done.value = new Done();
    function Fail() {

    };
    Fail.value = new Fail();
    function Unify(value0, value1) {
        this.value0 = value0;
        this.value1 = value1;
    };
    Unify.create = function (value0) {
        return function (value1) {
            return new Unify(value0, value1);
        };
    };
    function Fresh(value0, value1) {
        this.value0 = value0;
        this.value1 = value1;
    };
    Fresh.create = function (value0) {
        return function (value1) {
            return new Fresh(value0, value1);
        };
    };
    function Disj(value0) {
        this.value0 = value0;
    };
    Disj.create = function (value0) {
        return new Disj(value0);
    };
    function Conj(value0) {
        this.value0 = value0;
    };
    Conj.create = function (value0) {
        return new Conj(value0);
    };
    function Named(value0, value1) {
        this.value0 = value0;
        this.value1 = value1;
    };
    Named.create = function (value0) {
        return function (value1) {
            return new Named(value0, value1);
        };
    };
    function Define(value0, value1, value2) {
        this.value0 = value0;
        this.value1 = value1;
        this.value2 = value2;
    };
    Define.create = function (value0) {
        return function (value1) {
            return function (value2) {
                return new Define(value0, value1, value2);
            };
        };
    };
    return {
        Conj: Conj, 
        Define: Define, 
        Disj: Disj, 
        Done: Done, 
        Fail: Fail, 
        Fresh: Fresh, 
        Named: Named, 
        Unify: Unify
    };
})();
var PS = PS || {};
PS.Data_String = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Data_Function = PS.Data_Function;
    var Data_Maybe = PS.Data_Maybe;
    
    function _charAt(i, s, Just, Nothing) {
      return i >= 0 && i < s.length ? Just(s.charAt(i)) : Nothing;
    }
    ;
    
    function indexOf(x) {
      return function(s) {
        return s.indexOf(x);
      };
    }
    ;
    
    function length(s) {
      return s.length;
    }
    ;
    
    function drop(n) {
      return function(s) {
        return s.substr(n);
      };
    }
    ;
    
    function joinWith(s) {
      return function(xs) {
        return xs.join(s);
      };
    }
    ;
    var charAt = function (n) {
        return function (s) {
            return _charAt(n, s, Data_Maybe.Just.create, Data_Maybe.Nothing.value);
        };
    };
    return {
        charAt: charAt, 
        drop: drop, 
        indexOf: indexOf, 
        joinWith: joinWith, 
        length: length
    };
})();
var PS = PS || {};
PS.Data_Traversable = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Data_Array = PS.Data_Array;
    var Data_Foldable = PS.Data_Foldable;
    function Traversable(__superclass_Data$dotFoldable$dotFoldable_1, __superclass_Prelude$dotFunctor_0, sequence, traverse) {
        this["__superclass_Data.Foldable.Foldable_1"] = __superclass_Data$dotFoldable$dotFoldable_1;
        this["__superclass_Prelude.Functor_0"] = __superclass_Prelude$dotFunctor_0;
        this.sequence = sequence;
        this.traverse = traverse;
    };
    var traverse = function (dict) {
        return dict.traverse;
    };
    var sequence = function (dict) {
        return dict.sequence;
    };
    var traversableArray = new Traversable(function () {
        return Data_Foldable.foldableArray;
    }, function () {
        return Data_Array.functorArray;
    }, function (__dict_Applicative_347) {
        return function (_396) {
            if (_396.length === 0) {
                return Prelude.pure(__dict_Applicative_347)([  ]);
            };
            if (_396.length >= 1) {
                var _522 = _396.slice(1);
                return Prelude["<*>"](__dict_Applicative_347["__superclass_Prelude.Apply_0"]())(Prelude["<$>"]((__dict_Applicative_347["__superclass_Prelude.Apply_0"]())["__superclass_Prelude.Functor_0"]())(Prelude[":"])(_396[0]))(sequence(traversableArray)(__dict_Applicative_347)(_522));
            };
            throw new Error("Failed pattern match");
        };
    }, function (__dict_Applicative_346) {
        return function (_394) {
            return function (_395) {
                if (_395.length === 0) {
                    return Prelude.pure(__dict_Applicative_346)([  ]);
                };
                if (_395.length >= 1) {
                    var _526 = _395.slice(1);
                    return Prelude["<*>"](__dict_Applicative_346["__superclass_Prelude.Apply_0"]())(Prelude["<$>"]((__dict_Applicative_346["__superclass_Prelude.Apply_0"]())["__superclass_Prelude.Functor_0"]())(Prelude[":"])(_394(_395[0])))(traverse(traversableArray)(__dict_Applicative_346)(_394)(_526));
                };
                throw new Error("Failed pattern match");
            };
        };
    });
    var $$for = function (__dict_Applicative_349) {
        return function (__dict_Traversable_350) {
            return function (x) {
                return function (f) {
                    return traverse(__dict_Traversable_350)(__dict_Applicative_349)(f)(x);
                };
            };
        };
    };
    return {
        Traversable: Traversable, 
        "for": $$for, 
        sequence: sequence, 
        traversableArray: traversableArray, 
        traverse: traverse
    };
})();
var PS = PS || {};
PS.Data_Foreign_Class = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Data_Foreign = PS.Data_Foreign;
    function IsForeign(read) {
        this.read = read;
    };
    var stringIsForeign = new IsForeign(Data_Foreign.readString);
    var read = function (dict) {
        return dict.read;
    };
    return {
        IsForeign: IsForeign, 
        read: read, 
        stringIsForeign: stringIsForeign
    };
})();
var PS = PS || {};
PS.Kanren_Subst = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Kanren_Term = PS.Kanren_Term;
    var Data_Maybe = PS.Data_Maybe;
    var Data_Foldable = PS.Data_Foldable;
    var Kanren_Var = PS.Kanren_Var;
    var Data_Tuple = PS.Data_Tuple;
    var walk = function (_409) {
        return function (_410) {
            if (_410 instanceof Kanren_Term.TmVar) {
                return Data_Maybe.fromMaybe(new Kanren_Term.TmVar(_410.value0))(Data_Foldable.lookup(Kanren_Var.eqVar)(Data_Foldable.foldableArray)(_410.value0)(_409));
            };
            if (_410 instanceof Kanren_Term.TmPair) {
                return new Kanren_Term.TmPair(walk(_409)(_410.value0), walk(_409)(_410.value1));
            };
            return _410;
        };
    };
    var ext = function (v) {
        return function (t) {
            return function (s) {
                return Prelude[":"](new Data_Tuple.Tuple(v, t))(s);
            };
        };
    };
    return {
        ext: ext, 
        walk: walk
    };
})();
var PS = PS || {};
PS.Kanren_State = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    function State(value0, value1, value2, value3) {
        this.value0 = value0;
        this.value1 = value1;
        this.value2 = value2;
        this.value3 = value3;
    };
    State.create = function (value0) {
        return function (value1) {
            return function (value2) {
                return function (value3) {
                    return new State(value0, value1, value2, value3);
                };
            };
        };
    };
    return {
        State: State
    };
})();
var PS = PS || {};
PS.Kanren_Unify = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Kanren_Term = PS.Kanren_Term;
    var Kanren_Var = PS.Kanren_Var;
    var Data_Maybe = PS.Data_Maybe;
    var Kanren_Subst = PS.Kanren_Subst;
    var Kanren_Obj = PS.Kanren_Obj;
    var unify = function (u) {
        return function (v) {
            return function (s) {
                var go = function (_416) {
                    return function (_417) {
                        if (_416 instanceof Kanren_Term.TmVar && (_417 instanceof Kanren_Term.TmVar && Prelude["=="](Kanren_Var.eqVar)(_416.value0)(_417.value0))) {
                            return new Data_Maybe.Just(s);
                        };
                        if (_416 instanceof Kanren_Term.TmVar) {
                            return Data_Maybe.Just.create(Kanren_Subst.ext(_416.value0)(_417)(s));
                        };
                        if (_417 instanceof Kanren_Term.TmVar) {
                            return Data_Maybe.Just.create(Kanren_Subst.ext(_417.value0)(_416)(s));
                        };
                        if (_416 instanceof Kanren_Term.TmObj && (_417 instanceof Kanren_Term.TmObj && Prelude["=="](Kanren_Obj.eqObj)(_416.value0)(_417.value0))) {
                            return new Data_Maybe.Just(s);
                        };
                        if (_416 instanceof Kanren_Term.TmPair && _417 instanceof Kanren_Term.TmPair) {
                            var _540 = unify(_416.value0)(_417.value0)(s);
                            if (_540 instanceof Data_Maybe.Nothing) {
                                return Data_Maybe.Nothing.value;
                            };
                            if (_540 instanceof Data_Maybe.Just) {
                                return unify(_416.value1)(_417.value1)(_540.value0);
                            };
                            throw new Error("Failed pattern match");
                        };
                        return Data_Maybe.Nothing.value;
                    };
                };
                return go(Kanren_Subst.walk(s)(u))(Kanren_Subst.walk(s)(v));
            };
        };
    };
    return {
        unify: unify
    };
})();
var PS = PS || {};
PS.Kanren_Eval = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Kanren_Term = PS.Kanren_Term;
    var Kanren_Obj = PS.Kanren_Obj;
    var Kanren_Goal = PS.Kanren_Goal;
    var Data_Foldable = PS.Data_Foldable;
    var Data_Array = PS.Data_Array;
    var Data_Tuple = PS.Data_Tuple;
    var Data_Maybe = PS.Data_Maybe;
    var Data_Either = PS.Data_Either;
    var replace = function (nm) {
        return function (r) {
            var onTerms = function (_421) {
                if (_421 instanceof Kanren_Term.TmObj && nm === _421.value0) {
                    return r;
                };
                if (_421 instanceof Kanren_Term.TmPair) {
                    return new Kanren_Term.TmPair(onTerms(_421.value0), onTerms(_421.value1));
                };
                return _421;
            };
            var onGoals = function (_420) {
                if (_420 instanceof Kanren_Goal.Done) {
                    return Kanren_Goal.Done.value;
                };
                if (_420 instanceof Kanren_Goal.Unify) {
                    return new Kanren_Goal.Unify(onTerms(_420.value0), onTerms(_420.value1));
                };
                if (_420 instanceof Kanren_Goal.Fresh) {
                    return Data_Foldable.elem(Prelude.eqString)(Data_Foldable.foldableArray)(nm)(_420.value0) ? _420 : new Kanren_Goal.Fresh(_420.value0, onGoals(_420.value1));
                };
                if (_420 instanceof Kanren_Goal.Disj) {
                    return new Kanren_Goal.Disj(Prelude["<$>"](Data_Array.functorArray)(onGoals)(_420.value0));
                };
                if (_420 instanceof Kanren_Goal.Conj) {
                    return new Kanren_Goal.Conj(Prelude["<$>"](Data_Array.functorArray)(onGoals)(_420.value0));
                };
                if (_420 instanceof Kanren_Goal.Named) {
                    return new Kanren_Goal.Named(_420.value0, Prelude["<$>"](Data_Array.functorArray)(onTerms)(_420.value1));
                };
                throw new Error("Failed pattern match");
            };
            return onGoals;
        };
    };
    var replaceAll = Data_Foldable.foldl(Data_Foldable.foldableArray)(function (f) {
        return function (_418) {
            return function (g) {
                return replace(_418.value0)(_418.value1)(f(g));
            };
        };
    })(Prelude.id(Prelude.categoryArr));
    var builtIn = function (defines) {
        return function (nm) {
            return function (args) {
                var _566 = Data_Foldable.find(Data_Foldable.foldableArray)(function (_419) {
                    return nm === _419.value0;
                })(defines);
                if (_566 instanceof Data_Maybe.Just && Data_Array.length(_566.value0.value1) === Data_Array.length(args)) {
                    return Data_Either.Right.create(replaceAll(Data_Tuple.zip(_566.value0.value1)(args))(_566.value0.value2));
                };
                if (_566 instanceof Data_Maybe.Just) {
                    return Data_Either.Left.create("Incorrect number of arguments to " + Prelude.show(Prelude.showString)(nm));
                };
                if (_566 instanceof Data_Maybe.Nothing) {
                    return Data_Either.Left.create("Unknown function " + Prelude.show(Prelude.showString)(nm));
                };
                throw new Error("Failed pattern match");
            };
        };
    };
    return {
        builtIn: builtIn, 
        replace: replace, 
        replaceAll: replaceAll
    };
})();
var PS = PS || {};
PS.Text_Parsing_Parser = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Control_Monad_Identity = PS.Control_Monad_Identity;
    var Control_Lazy = PS.Control_Lazy;
    var Data_Either = PS.Data_Either;
    var Control_Monad_Error = PS.Control_Monad_Error;
    var Control_Alt = PS.Control_Alt;
    var Control_Plus = PS.Control_Plus;
    var Control_Alternative = PS.Control_Alternative;
    function ParseError(value0) {
        this.value0 = value0;
    };
    ParseError.create = function (value0) {
        return new ParseError(value0);
    };
    var ParserT = {
        create: function (value) {
            return value;
        }
    };
    var unParserT = function (_422) {
        return _422;
    };
    var runParserT = function (__dict_Monad_359) {
        return function (s) {
            return function (p) {
                return Prelude[">>="](__dict_Monad_359["__superclass_Prelude.Bind_1"]())(unParserT(p)(s))(function (_25) {
                    return Prelude["return"](__dict_Monad_359)(_25.result);
                });
            };
        };
    };
    var runParser = function (s) {
        return Prelude["<<<"](Prelude.semigroupoidArr)(Control_Monad_Identity.runIdentity)(runParserT(Control_Monad_Identity.monadIdentity)(s));
    };
    var lazy1ParserT = new Control_Lazy.Lazy1(function (f) {
        return ParserT.create(function (s) {
            return unParserT(f(Prelude.unit))(s);
        });
    });
    var functorParserT = function (__dict_Functor_364) {
        return new Prelude.Functor(function (f) {
            return function (p) {
                var f$prime = function (o) {
                    return {
                        input: o.input, 
                        result: Prelude["<$>"](Data_Either.functorEither)(f)(o.result), 
                        consumed: o.consumed
                    };
                };
                return ParserT.create(function (s) {
                    return Prelude["<$>"](__dict_Functor_364)(f$prime)(unParserT(p)(s));
                });
            };
        });
    };
    var fail = function (__dict_Monad_365) {
        return function (message) {
            return ParserT.create(function (s) {
                return Prelude["return"](__dict_Monad_365)({
                    input: s, 
                    consumed: false, 
                    result: new Data_Either.Left(new ParseError({
                        message: message
                    }))
                });
            });
        };
    };
    var errorParseError = new Control_Monad_Error.Error(new ParseError({
        message: ""
    }), function (msg) {
        return new ParseError({
            message: msg
        });
    });
    var monadParserT = function (__dict_Monad_363) {
        return new Prelude.Monad(function () {
            return applicativeParserT(__dict_Monad_363);
        }, function () {
            return bindParserT(__dict_Monad_363);
        });
    };
    var bindParserT = function (__dict_Monad_368) {
        return new Prelude.Bind(function (p) {
            return function (f) {
                var updateConsumedFlag = function (c) {
                    return function (o) {
                        return {
                            input: o.input, 
                            consumed: c || o.consumed, 
                            result: o.result
                        };
                    };
                };
                return ParserT.create(function (s) {
                    return Prelude[">>="](__dict_Monad_368["__superclass_Prelude.Bind_1"]())(unParserT(p)(s))(function (o) {
                        if (o.result instanceof Data_Either.Left) {
                            return Prelude["return"](__dict_Monad_368)({
                                input: o.input, 
                                result: new Data_Either.Left(o.result.value0), 
                                consumed: o.consumed
                            });
                        };
                        if (o.result instanceof Data_Either.Right) {
                            return Prelude["<$>"](((__dict_Monad_368["__superclass_Prelude.Applicative_0"]())["__superclass_Prelude.Apply_0"]())["__superclass_Prelude.Functor_0"]())(updateConsumedFlag(o.consumed))(unParserT(f(o.result.value0))(o.input));
                        };
                        throw new Error("Failed pattern match");
                    });
                });
            };
        }, function () {
            return applyParserT(__dict_Monad_368);
        });
    };
    var applyParserT = function (__dict_Monad_369) {
        return new Prelude.Apply(Prelude.ap(monadParserT(__dict_Monad_369)), function () {
            return functorParserT(((__dict_Monad_369["__superclass_Prelude.Applicative_0"]())["__superclass_Prelude.Apply_0"]())["__superclass_Prelude.Functor_0"]());
        });
    };
    var applicativeParserT = function (__dict_Monad_370) {
        return new Prelude.Applicative(function () {
            return applyParserT(__dict_Monad_370);
        }, function (a) {
            return ParserT.create(function (s) {
                return Prelude.pure(__dict_Monad_370["__superclass_Prelude.Applicative_0"]())({
                    input: s, 
                    result: new Data_Either.Right(a), 
                    consumed: false
                });
            });
        });
    };
    var altParserT = function (__dict_Monad_372) {
        return new Control_Alt.Alt(function (p1) {
            return function (p2) {
                return ParserT.create(function (s) {
                    return Prelude[">>="](__dict_Monad_372["__superclass_Prelude.Bind_1"]())(unParserT(p1)(s))(function (o) {
                        if (o.result instanceof Data_Either.Left && !o.consumed) {
                            return unParserT(p2)(s);
                        };
                        return Prelude["return"](__dict_Monad_372)(o);
                    });
                });
            };
        }, function () {
            return functorParserT(((__dict_Monad_372["__superclass_Prelude.Applicative_0"]())["__superclass_Prelude.Apply_0"]())["__superclass_Prelude.Functor_0"]());
        });
    };
    var plusParserT = function (__dict_Monad_366) {
        return new Control_Plus.Plus(function () {
            return altParserT(__dict_Monad_366);
        }, fail(__dict_Monad_366)("No alternative"));
    };
    var alternativeParserT = function (__dict_Monad_371) {
        return new Control_Alternative.Alternative(function () {
            return plusParserT(__dict_Monad_371);
        }, function () {
            return applicativeParserT(__dict_Monad_371);
        });
    };
    return {
        ParseError: ParseError, 
        ParserT: ParserT, 
        altParserT: altParserT, 
        alternativeParserT: alternativeParserT, 
        applicativeParserT: applicativeParserT, 
        applyParserT: applyParserT, 
        bindParserT: bindParserT, 
        errorParseError: errorParseError, 
        fail: fail, 
        functorParserT: functorParserT, 
        lazy1ParserT: lazy1ParserT, 
        monadParserT: monadParserT, 
        plusParserT: plusParserT, 
        runParser: runParser, 
        runParserT: runParserT, 
        unParserT: unParserT
    };
})();
var PS = PS || {};
PS.Text_Parsing_Parser_Combinators = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Data_Either = PS.Data_Either;
    var Text_Parsing_Parser = PS.Text_Parsing_Parser;
    var $$try = function (__dict_Functor_374) {
        return function (p) {
            var try$prime = function (_426) {
                return function (_427) {
                    if (_427.result instanceof Data_Either.Left) {
                        return {
                            input: _426, 
                            result: _427.result, 
                            consumed: false
                        };
                    };
                    return _427;
                };
            };
            return Text_Parsing_Parser.ParserT.create(function (s) {
                return Prelude["<$>"](__dict_Functor_374)(try$prime(s))(Text_Parsing_Parser.unParserT(p)(s));
            });
        };
    };
    return {
        "try": $$try
    };
})();
var PS = PS || {};
PS.Text_Parsing_Parser_String = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Text_Parsing_Parser = PS.Text_Parsing_Parser;
    var Data_String = PS.Data_String;
    var Data_Either = PS.Data_Either;
    var Control_Monad_Error = PS.Control_Monad_Error;
    var Control_Alternative = PS.Control_Alternative;
    var Control_Alt = PS.Control_Alt;
    var Data_Foldable = PS.Data_Foldable;
    var Data_Monoid = PS.Data_Monoid;
    var Data_Maybe = PS.Data_Maybe;
    var Data_Char = PS.Data_Char;
    var Text_Parsing_Parser_Combinators = PS.Text_Parsing_Parser_Combinators;
    var string = function (__dict_Monad_405) {
        return function (s) {
            return Text_Parsing_Parser.ParserT.create(function (s$prime) {
                return Prelude["return"](__dict_Monad_405)((function () {
                    var _583 = Data_String.indexOf(s)(s$prime);
                    if (_583 === 0) {
                        return {
                            consumed: true, 
                            input: Data_String.drop(Data_String.length(s))(s$prime), 
                            result: new Data_Either.Right(s)
                        };
                    };
                    return {
                        consumed: false, 
                        input: s$prime, 
                        result: new Data_Either.Left(Control_Monad_Error.strMsg(Text_Parsing_Parser.errorParseError)("Expected " + Prelude.show(Prelude.showString)(s)))
                    };
                })());
            });
        };
    };
    var whiteSpace = function (__dict_Monad_406) {
        return Prelude[">>="](Text_Parsing_Parser.bindParserT(__dict_Monad_406))(Control_Alternative.many(Text_Parsing_Parser.alternativeParserT(__dict_Monad_406))(Text_Parsing_Parser.lazy1ParserT)(Control_Alt["<|>"](Text_Parsing_Parser.altParserT(__dict_Monad_406))(Control_Alt["<|>"](Text_Parsing_Parser.altParserT(__dict_Monad_406))(Control_Alt["<|>"](Text_Parsing_Parser.altParserT(__dict_Monad_406))(string(__dict_Monad_406)("\n"))(string(__dict_Monad_406)("\r")))(string(__dict_Monad_406)(" ")))(string(__dict_Monad_406)("\t"))))(function (_58) {
            return Prelude["return"](Text_Parsing_Parser.monadParserT(__dict_Monad_406))(Data_Foldable.foldMap(Data_Foldable.foldableArray)(Data_Monoid.monoidString)(Prelude.id(Prelude.categoryArr))(_58));
        });
    };
    var eof = function (__dict_Monad_408) {
        return Text_Parsing_Parser.ParserT.create(function (s) {
            return Prelude["return"](__dict_Monad_408)((function () {
                if (s === "") {
                    return {
                        consumed: false, 
                        input: s, 
                        result: new Data_Either.Right(Prelude.unit)
                    };
                };
                return {
                    consumed: false, 
                    input: s, 
                    result: new Data_Either.Left(Control_Monad_Error.strMsg(Text_Parsing_Parser.errorParseError)("Expected EOF"))
                };
            })());
        });
    };
    var $$char = function (__dict_Monad_409) {
        return Text_Parsing_Parser.ParserT.create(function (s$prime) {
            return Prelude["return"](__dict_Monad_409)((function () {
                var _586 = Data_String.charAt(0)(s$prime);
                if (_586 instanceof Data_Maybe.Nothing) {
                    return {
                        consumed: false, 
                        input: s$prime, 
                        result: new Data_Either.Left(Control_Monad_Error.strMsg(Text_Parsing_Parser.errorParseError)("Unexpected EOF"))
                    };
                };
                if (_586 instanceof Data_Maybe.Just) {
                    return {
                        consumed: true, 
                        input: Data_String.drop(1)(s$prime), 
                        result: new Data_Either.Right(Data_Char.charString(_586.value0))
                    };
                };
                throw new Error("Failed pattern match");
            })());
        });
    };
    var satisfy = function (__dict_Monad_410) {
        return function (f) {
            return Text_Parsing_Parser_Combinators["try"](((__dict_Monad_410["__superclass_Prelude.Applicative_0"]())["__superclass_Prelude.Apply_0"]())["__superclass_Prelude.Functor_0"]())(Prelude[">>="](Text_Parsing_Parser.bindParserT(__dict_Monad_410))($$char(__dict_Monad_410))(function (_57) {
                return f(_57) ? Prelude["return"](Text_Parsing_Parser.monadParserT(__dict_Monad_410))(_57) : Text_Parsing_Parser.fail(__dict_Monad_410)("Character did not satisfy predicate");
            }));
        };
    };
    var noneOf = function (__dict_Monad_411) {
        return function (ss) {
            return satisfy(__dict_Monad_411)(Prelude.flip(Data_Foldable.notElem(Prelude.eqString)(Data_Foldable.foldableArray))(ss));
        };
    };
    return {
        "char": $$char, 
        eof: eof, 
        noneOf: noneOf, 
        satisfy: satisfy, 
        string: string, 
        whiteSpace: whiteSpace
    };
})();
var PS = PS || {};
PS.Kanren_Parser = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Data_Either = PS.Data_Either;
    var Kanren_Term = PS.Kanren_Term;
    var Text_Parsing_Parser = PS.Text_Parsing_Parser;
    var Control_Monad_Identity = PS.Control_Monad_Identity;
    var Data_String = PS.Data_String;
    var Control_Alternative = PS.Control_Alternative;
    var Text_Parsing_Parser_String = PS.Text_Parsing_Parser_String;
    var Control_Apply = PS.Control_Apply;
    var Control_Lazy = PS.Control_Lazy;
    var Control_Alt = PS.Control_Alt;
    var Text_Parsing_Parser_Combinators = PS.Text_Parsing_Parser_Combinators;
    var Data_Array = PS.Data_Array;
    var Kanren_Goal = PS.Kanren_Goal;
    var Data_Traversable = PS.Data_Traversable;
    var Data_Array_Unsafe = PS.Data_Array_Unsafe;
    function Atom(value0) {
        this.value0 = value0;
    };
    Atom.create = function (value0) {
        return new Atom(value0);
    };
    function Sexpr(value0) {
        this.value0 = value0;
    };
    Sexpr.create = function (value0) {
        return new Sexpr(value0);
    };
    var sexprToTerm = function (_431) {
        if (_431 instanceof Atom) {
            return Data_Either.Right.create(Kanren_Term.obj(_431.value0));
        };
        if (_431 instanceof Sexpr && _431.value0.length === 2) {
            return Prelude["<*>"](Data_Either.applyEither)(Prelude["<$>"](Data_Either.functorEither)(Kanren_Term.TmPair.create)(sexprToTerm(_431.value0[0])))(sexprToTerm(_431.value0[1]));
        };
        return new Data_Either.Left("Invalid term");
    };
    var parseSexpr = (function () {
        var parseAtom = Prelude["<$>"](Text_Parsing_Parser.functorParserT(Control_Monad_Identity.functorIdentity))(Prelude["<<<"](Prelude.semigroupoidArr)(Atom.create)(Data_String.joinWith("")))(Control_Alternative.some(Text_Parsing_Parser.alternativeParserT(Control_Monad_Identity.monadIdentity))(Text_Parsing_Parser.lazy1ParserT)(Text_Parsing_Parser_String.noneOf(Control_Monad_Identity.monadIdentity)([ " ", ")", "(", "\n", "\t", "\r" ])));
        var parens = function (p) {
            return Control_Apply["<*"](Text_Parsing_Parser.applyParserT(Control_Monad_Identity.monadIdentity))(Control_Apply["<*"](Text_Parsing_Parser.applyParserT(Control_Monad_Identity.monadIdentity))(Control_Apply["*>"](Text_Parsing_Parser.applyParserT(Control_Monad_Identity.monadIdentity))(Control_Apply["*>"](Text_Parsing_Parser.applyParserT(Control_Monad_Identity.monadIdentity))(Text_Parsing_Parser_String.string(Control_Monad_Identity.monadIdentity)("("))(Text_Parsing_Parser_String.whiteSpace(Control_Monad_Identity.monadIdentity)))(p))(Text_Parsing_Parser_String.whiteSpace(Control_Monad_Identity.monadIdentity)))(Text_Parsing_Parser_String.string(Control_Monad_Identity.monadIdentity)(")"));
        };
        return Control_Lazy.fix1(Text_Parsing_Parser.lazy1ParserT)(function (p) {
            return Control_Apply["<*"](Text_Parsing_Parser.applyParserT(Control_Monad_Identity.monadIdentity))(Control_Apply["*>"](Text_Parsing_Parser.applyParserT(Control_Monad_Identity.monadIdentity))(Text_Parsing_Parser_String.whiteSpace(Control_Monad_Identity.monadIdentity))(Control_Alt["<|>"](Text_Parsing_Parser.altParserT(Control_Monad_Identity.monadIdentity))(Text_Parsing_Parser_Combinators["try"](Control_Monad_Identity.functorIdentity)(parseAtom))(parens(Prelude["<$>"](Text_Parsing_Parser.functorParserT(Control_Monad_Identity.functorIdentity))(Sexpr.create)(Control_Alternative.many(Text_Parsing_Parser.alternativeParserT(Control_Monad_Identity.monadIdentity))(Text_Parsing_Parser.lazy1ParserT)(p))))))(Text_Parsing_Parser_String.whiteSpace(Control_Monad_Identity.monadIdentity));
        });
    })();
    var fromAtom = function (_432) {
        if (_432 instanceof Atom) {
            return new Data_Either.Right(_432.value0);
        };
        return new Data_Either.Left("Expected atom");
    };
    var sexprToGoal = function (_430) {
        if (_430 instanceof Sexpr && _430.value0.length >= 1) {
            var _600 = _430.value0.slice(1);
            if (_430.value0[0] instanceof Atom && ((_430.value0[0]).value0 === "fresh" && Data_Array.length(_600) > 1)) {
                return Prelude["<*>"](Data_Either.applyEither)(Prelude["<$>"](Data_Either.functorEither)(Kanren_Goal.Fresh.create)(Data_Traversable.traverse(Data_Traversable.traversableArray)(Data_Either.applicativeEither)(fromAtom)(Data_Array_Unsafe.init(_600))))(sexprToGoal(Data_Array_Unsafe.last(_600)));
            };
        };
        if (_430 instanceof Sexpr && _430.value0.length >= 1) {
            var _604 = _430.value0.slice(1);
            if (_430.value0[0] instanceof Atom && (_430.value0[0]).value0 === "fresh") {
                return new Data_Either.Left("fresh expects two or more arguments");
            };
        };
        if (_430 instanceof Sexpr && (_430.value0.length === 3 && (_430.value0[0] instanceof Atom && (_430.value0[0]).value0 === "="))) {
            return Prelude["<*>"](Data_Either.applyEither)(Prelude["<$>"](Data_Either.functorEither)(Kanren_Goal.Unify.create)(sexprToTerm(_430.value0[1])))(sexprToTerm(_430.value0[2]));
        };
        if (_430 instanceof Sexpr && _430.value0.length >= 1) {
            var _613 = _430.value0.slice(1);
            if (_430.value0[0] instanceof Atom && (_430.value0[0]).value0 === "=") {
                return new Data_Either.Left("= expects two arguments");
            };
        };
        if (_430 instanceof Sexpr && _430.value0.length >= 1) {
            var _617 = _430.value0.slice(1);
            if (_430.value0[0] instanceof Atom && ((_430.value0[0]).value0 === "disj" && Data_Array.length(_617) > 1)) {
                return Prelude["<$>"](Data_Either.functorEither)(Kanren_Goal.Disj.create)(Data_Traversable.traverse(Data_Traversable.traversableArray)(Data_Either.applicativeEither)(sexprToGoal)(_617));
            };
        };
        if (_430 instanceof Sexpr && _430.value0.length >= 1) {
            var _621 = _430.value0.slice(1);
            if (_430.value0[0] instanceof Atom && (_430.value0[0]).value0 === "disj") {
                return new Data_Either.Left("disj expects at least two arguments");
            };
        };
        if (_430 instanceof Sexpr && _430.value0.length >= 1) {
            var _625 = _430.value0.slice(1);
            if (_430.value0[0] instanceof Atom && ((_430.value0[0]).value0 === "conj" && Data_Array.length(_625) > 1)) {
                return Prelude["<$>"](Data_Either.functorEither)(Kanren_Goal.Conj.create)(Data_Traversable.traverse(Data_Traversable.traversableArray)(Data_Either.applicativeEither)(sexprToGoal)(_625));
            };
        };
        if (_430 instanceof Sexpr && _430.value0.length >= 1) {
            var _629 = _430.value0.slice(1);
            if (_430.value0[0] instanceof Atom && (_430.value0[0]).value0 === "conj") {
                return new Data_Either.Left("conj expects at least two arguments");
            };
        };
        if (_430 instanceof Sexpr && _430.value0.length >= 1) {
            var _633 = _430.value0.slice(1);
            if (_430.value0[0] instanceof Atom) {
                return Prelude["<$>"](Data_Either.functorEither)(Kanren_Goal.Named.create((_430.value0[0]).value0))(Data_Traversable.traverse(Data_Traversable.traversableArray)(Data_Either.applicativeEither)(sexprToTerm)(_633));
            };
        };
        return new Data_Either.Left("Cannot parse goal");
    };
    var parseDefines = function (s) {
        var sexprToDefine = function (_434) {
            if (_434 instanceof Sexpr && _434.value0.length >= 2) {
                var _640 = _434.value0.slice(2);
                if (_434.value0[1] instanceof Atom && (_434.value0[0] instanceof Atom && ((_434.value0[0]).value0 === "define" && !Data_Array["null"](_640)))) {
                    return Prelude["<*>"](Data_Either.applyEither)(Prelude["<$>"](Data_Either.functorEither)(Kanren_Goal.Define.create((_434.value0[1]).value0))(Data_Traversable.traverse(Data_Traversable.traversableArray)(Data_Either.applicativeEither)(fromAtom)(Data_Array_Unsafe.init(_640))))(sexprToGoal(Data_Array_Unsafe.last(_640)));
                };
            };
            if (_434 instanceof Sexpr && _434.value0.length >= 1) {
                var _644 = _434.value0.slice(1);
                if (_434.value0[0] instanceof Atom && (_434.value0[0]).value0 === "define") {
                    return new Data_Either.Left("define expects two or more arguments");
                };
            };
            return new Data_Either.Left("Cannot parse definition");
        };
        var _645 = Text_Parsing_Parser.runParser(s)(Control_Apply["<*"](Text_Parsing_Parser.applyParserT(Control_Monad_Identity.monadIdentity))(Control_Alternative.many(Text_Parsing_Parser.alternativeParserT(Control_Monad_Identity.monadIdentity))(Text_Parsing_Parser.lazy1ParserT)(parseSexpr))(Text_Parsing_Parser_String.eof(Control_Monad_Identity.monadIdentity)));
        if (_645 instanceof Data_Either.Left) {
            return new Data_Either.Left(_645.value0.value0.message);
        };
        if (_645 instanceof Data_Either.Right) {
            return Data_Traversable.traverse(Data_Traversable.traversableArray)(Data_Either.applicativeEither)(sexprToDefine)(_645.value0);
        };
        throw new Error("Failed pattern match");
    };
    var parseGoal = function (s) {
        var _649 = Text_Parsing_Parser.runParser(s)(Control_Apply["<*"](Text_Parsing_Parser.applyParserT(Control_Monad_Identity.monadIdentity))(parseSexpr)(Text_Parsing_Parser_String.eof(Control_Monad_Identity.monadIdentity)));
        if (_649 instanceof Data_Either.Left) {
            return new Data_Either.Left(_649.value0.value0.message);
        };
        if (_649 instanceof Data_Either.Right) {
            return sexprToGoal(_649.value0);
        };
        throw new Error("Failed pattern match");
    };
    return {
        parseDefines: parseDefines, 
        parseGoal: parseGoal
    };
})();
var PS = PS || {};
PS.Kanren_Render = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Control_Monad_Eff = PS.Control_Monad_Eff;
    var Control_Monad_JQuery = PS.Control_Monad_JQuery;
    var Control_Monad_Eff_Ref = PS.Control_Monad_Eff_Ref;
    var Kanren_State = PS.Kanren_State;
    var Kanren_Goal = PS.Kanren_Goal;
    var Kanren_Term = PS.Kanren_Term;
    var Kanren_Var = PS.Kanren_Var;
    var Kanren_Obj = PS.Kanren_Obj;
    var Data_Foldable = PS.Data_Foldable;
    var Data_Monoid = PS.Data_Monoid;
    var Control_Apply = PS.Control_Apply;
    var Data_Tuple = PS.Data_Tuple;
    var Data_Array = PS.Data_Array;
    var Kanren_Eval = PS.Kanren_Eval;
    var Kanren_Unify = PS.Kanren_Unify;
    var Data_Maybe = PS.Data_Maybe;
    var Data_Either = PS.Data_Either;
    var Data_Traversable = PS.Data_Traversable;
    var Data_Function = PS.Data_Function;
    var Kanren_Subst = PS.Kanren_Subst;
    var Data_Foreign_Class = PS.Data_Foreign_Class;
    var Data_Foreign = PS.Data_Foreign;
    var Kanren_Parser = PS.Kanren_Parser;
    var showError = function (err) {
        return Prelude["void"](Control_Monad_Eff.functorEff)(function __do() {
            var _60 = Control_Monad_JQuery.create("<button type='button' class='close' data-dismiss='alert'>&times;</button>")();
            var _59 = Prelude[">>="](Control_Monad_Eff.bindEff)(Prelude[">>="](Control_Monad_Eff.bindEff)(Prelude[">>="](Control_Monad_Eff.bindEff)(Prelude[">>="](Control_Monad_Eff.bindEff)(Control_Monad_JQuery.create("<div>"))(Control_Monad_JQuery.addClass("alert alert-danger alert-dismissible")))(Control_Monad_JQuery.attr({
                role: "alert"
            })))(Control_Monad_JQuery.append(_60)))(Control_Monad_JQuery.appendText(err))();
            return Prelude[">>="](Control_Monad_Eff.bindEff)(Control_Monad_JQuery.select("#error"))(Control_Monad_JQuery.append(_59))();
        });
    };
    var showEditor = Prelude["void"](Control_Monad_Eff.functorEff)(function __do() {
        Prelude[">>="](Control_Monad_Eff.bindEff)(Control_Monad_JQuery.select("#editor"))(Control_Monad_JQuery.css({
            display: "block"
        }))();
        Prelude[">>="](Control_Monad_Eff.bindEff)(Control_Monad_JQuery.select("#goal"))(Control_Monad_JQuery.css({
            display: "none"
        }))();
        Prelude[">>="](Control_Monad_Eff.bindEff)(Control_Monad_JQuery.select("#editButton"))(Control_Monad_JQuery.css({
            display: "none"
        }))();
        return Prelude[">>="](Control_Monad_Eff.bindEff)(Control_Monad_JQuery.select("#undoButton"))(Control_Monad_JQuery.css({
            display: "none"
        }))();
    });
    var hideEditor = Prelude["void"](Control_Monad_Eff.functorEff)(function __do() {
        Prelude[">>="](Control_Monad_Eff.bindEff)(Control_Monad_JQuery.select("#editor"))(Control_Monad_JQuery.css({
            display: "none"
        }))();
        Prelude[">>="](Control_Monad_Eff.bindEff)(Control_Monad_JQuery.select("#goal"))(Control_Monad_JQuery.css({
            display: "block"
        }))();
        Prelude[">>="](Control_Monad_Eff.bindEff)(Control_Monad_JQuery.select("#editButton"))(Control_Monad_JQuery.css({
            display: "block"
        }))();
        return Prelude[">>="](Control_Monad_Eff.bindEff)(Control_Monad_JQuery.select("#undoButton"))(Control_Monad_JQuery.css({
            display: "block"
        }))();
    });
    var renderSavingState = function (definesRef) {
        return function (oldState) {
            return function (history) {
                return function (newState) {
                    return function __do() {
                        Control_Monad_Eff_Ref.modifyRef(history)(Prelude[":"](oldState))();
                        return render(definesRef)(history)(newState)();
                    };
                };
            };
        };
    };
    var render = function (_437) {
        return function (_438) {
            return function (_439) {
                var unwind = function (_444) {
                    if (_444.value0 instanceof Kanren_Goal.Done && _444.value3.length >= 1) {
                        var _664 = _444.value3.slice(1);
                        return new Kanren_State.State(_444.value3[0], _444.value1, _444.value2, _664);
                    };
                    return _444;
                };
                var spaces = (function () {
                    var go = function (__copy__448) {
                        return function (__copy__449) {
                            var _448 = __copy__448;
                            var _449 = __copy__449;
                            tco: while (true) {
                                if (_449 === 0) {
                                    return _448;
                                };
                                var __tco__448 = _448 + "  ";
                                var __tco__449 = _449 - 1;
                                _448 = __tco__448;
                                _449 = __tco__449;
                                continue tco;
                            };
                        };
                    };
                    return go("");
                })();
                var renderTerm = function (_447) {
                    if (_447 instanceof Kanren_Term.TmVar) {
                        return "#" + Prelude.show(Prelude.showNumber)(_447.value0);
                    };
                    if (_447 instanceof Kanren_Term.TmObj) {
                        return _447.value0;
                    };
                    if (_447 instanceof Kanren_Term.TmPair) {
                        return "(" + (renderTerm(_447.value0) + (" " + (renderTerm(_447.value1) + ")")));
                    };
                    throw new Error("Failed pattern match");
                };
                var renderShortGoal = function (_440) {
                    if (_440 instanceof Kanren_Goal.Done) {
                        return "Done";
                    };
                    if (_440 instanceof Kanren_Goal.Fresh) {
                        return "fresh " + Data_Foldable.intercalate(Data_Foldable.foldableArray)(Data_Monoid.monoidString)(" ")(_440.value0);
                    };
                    if (_440 instanceof Kanren_Goal.Unify) {
                        return renderTerm(_440.value0) + (" == " + renderTerm(_440.value1));
                    };
                    if (_440 instanceof Kanren_Goal.Disj) {
                        return "disj";
                    };
                    if (_440 instanceof Kanren_Goal.Conj) {
                        return "conj";
                    };
                    if (_440 instanceof Kanren_Goal.Named) {
                        return _440.value0;
                    };
                    throw new Error("Failed pattern match");
                };
                var newLine = Prelude[">>="](Control_Monad_Eff.bindEff)(Control_Monad_JQuery.create("<div>"))(Control_Monad_JQuery.addClass("line"));
                var linkTo = function (_445) {
                    return function (_446) {
                        if (_445) {
                            return Prelude[">>="](Control_Monad_Eff.bindEff)(Control_Monad_JQuery.create("<a href='#'>"))(Control_Monad_JQuery.on("click")(function (e) {
                                return function (_) {
                                    return Control_Apply["*>"](Control_Monad_Eff.applyEff)(_446)(Control_Monad_JQuery.preventDefault(e));
                                };
                            }));
                        };
                        if (!_445) {
                            return Control_Monad_JQuery.create("<span>");
                        };
                        throw new Error("Failed pattern match");
                    };
                };
                var indented = Prelude[">>="](Control_Monad_Eff.bindEff)(Control_Monad_JQuery.create("<div>"))(Control_Monad_JQuery.addClass("indented"));
                var inContext = (function () {
                    var go = function (__copy__450) {
                        return function (__copy__451) {
                            return function (__copy__452) {
                                var _450 = __copy__450;
                                var _451 = __copy__451;
                                var _452 = __copy__452;
                                tco: while (true) {
                                    if (_452.length === 0) {
                                        return _450;
                                    };
                                    if (_452.length >= 1) {
                                        var _687 = _452.slice(1);
                                        var __tco__450 = Prelude[":"](new Data_Tuple.Tuple(_452[0], Prelude["++"](Data_Array.semigroupArray)(_451)(_687)))(_450);
                                        var __tco__451 = Prelude["++"](Data_Array.semigroupArray)(_451)([ _452[0] ]);
                                        _450 = __tco__450;
                                        _451 = __tco__451;
                                        _452 = _687;
                                        continue tco;
                                    };
                                    throw new Error("Failed pattern match");
                                };
                            };
                        };
                    };
                    return go([  ])([  ]);
                })();
                var renderGoal = function (_441) {
                    return function (_442) {
                        return function (_443) {
                            if (_443 instanceof Kanren_Goal.Done) {
                                return Prelude["void"](Control_Monad_Eff.functorEff)(Control_Monad_JQuery.appendText("Evaluation complete")(_442));
                            };
                            if (_443 instanceof Kanren_Goal.Fail) {
                                return Prelude["void"](Control_Monad_Eff.functorEff)(Control_Monad_JQuery.appendText("Contradiction!")(_442));
                            };
                            if (_443 instanceof Kanren_Goal.Fresh) {
                                return Prelude["void"](Control_Monad_Eff.functorEff)((function () {
                                    var nextVar = Kanren_Var.runVar(_439.value2) + Data_Array.length(_443.value0);
                                    var freshNames = Prelude["<$>"](Data_Array.functorArray)(Prelude["<<<"](Prelude.semigroupoidArr)(Kanren_Term.TmVar.create)(Kanren_Var.Var.create))(Data_Array[".."](Kanren_Var.runVar(_439.value2))(Kanren_Var.runVar(_439.value2) + Data_Array.length(_443.value0) - 1));
                                    var newState = new Kanren_State.State(Kanren_Eval.replaceAll(Data_Tuple.zip(_443.value0)(freshNames))(_443.value1), _439.value1, nextVar, _439.value3);
                                    return function __do() {
                                        var _66 = Prelude[">>="](Control_Monad_Eff.bindEff)(linkTo(_441)(renderSavingState(_437)(_439)(_438)(newState)))(Control_Monad_JQuery.appendText("(fresh " + (Data_Foldable.intercalate(Data_Foldable.foldableArray)(Data_Monoid.monoidString)(" ")(_443.value0) + "")))();
                                        var _65 = Prelude[">>="](Control_Monad_Eff.bindEff)(newLine)(Control_Monad_JQuery.append(_66))();
                                        Control_Monad_JQuery.append(_65)(_442)();
                                        var _64 = indented();
                                        renderGoal(false)(_64)(_443.value1)();
                                        Control_Monad_JQuery.append(_64)(_442)();
                                        var _63 = Prelude[">>="](Control_Monad_Eff.bindEff)(newLine)(Control_Monad_JQuery.appendText(")"))();
                                        return Control_Monad_JQuery.append(_63)(_442)();
                                    };
                                })());
                            };
                            if (_443 instanceof Kanren_Goal.Unify) {
                                return Prelude["void"](Control_Monad_Eff.functorEff)((function () {
                                    var text = "(= " + (renderTerm(_443.value0) + (" " + (renderTerm(_443.value1) + ")")));
                                    var action = (function () {
                                        var _697 = Kanren_Unify.unify(_443.value0)(_443.value1)(_439.value1);
                                        if (_697 instanceof Data_Maybe.Nothing) {
                                            return renderSavingState(_437)(_439)(_438)(new Kanren_State.State(Kanren_Goal.Fail.value, _439.value1, _439.value2, _439.value3));
                                        };
                                        if (_697 instanceof Data_Maybe.Just) {
                                            return renderSavingState(_437)(_439)(_438)(unwind(new Kanren_State.State(Kanren_Goal.Done.value, _697.value0, _439.value2, _439.value3)));
                                        };
                                        throw new Error("Failed pattern match");
                                    })();
                                    return function __do() {
                                        var _68 = Prelude[">>="](Control_Monad_Eff.bindEff)(linkTo(_441)(action))(Control_Monad_JQuery.appendText(text))();
                                        var _67 = Prelude[">>="](Control_Monad_Eff.bindEff)(newLine)(Control_Monad_JQuery.append(_68))();
                                        return Control_Monad_JQuery.append(_67)(_442)();
                                    };
                                })());
                            };
                            if (_443 instanceof Kanren_Goal.Named) {
                                return Prelude[">>="](Control_Monad_Eff.bindEff)(Control_Monad_Eff_Ref.readRef(_437))(function (_71) {
                                    if (_71 instanceof Data_Maybe.Just) {
                                        var _704 = Kanren_Eval.builtIn(_71.value0)(_443.value0)(_443.value1);
                                        if (_704 instanceof Data_Either.Left) {
                                            return showError(_704.value0);
                                        };
                                        if (_704 instanceof Data_Either.Right) {
                                            return Prelude["void"](Control_Monad_Eff.functorEff)((function () {
                                                var text = "(" + (_443.value0 + (" " + (Data_Foldable.intercalate(Data_Foldable.foldableArray)(Data_Monoid.monoidString)(" ")(Prelude["<$>"](Data_Array.functorArray)(renderTerm)(_443.value1)) + ")")));
                                                var newState = new Kanren_State.State(_704.value0, _439.value1, _439.value2, _439.value3);
                                                return function __do() {
                                                    var _70 = Prelude[">>="](Control_Monad_Eff.bindEff)(linkTo(_441)(renderSavingState(_437)(_439)(_438)(newState)))(Control_Monad_JQuery.appendText(text))();
                                                    var _69 = Prelude[">>="](Control_Monad_Eff.bindEff)(newLine)(Control_Monad_JQuery.append(_70))();
                                                    return Control_Monad_JQuery.append(_69)(_442)();
                                                };
                                            })());
                                        };
                                        throw new Error("Failed pattern match");
                                    };
                                    throw new Error("Failed pattern match");
                                });
                            };
                            if (_443 instanceof Kanren_Goal.Disj) {
                                return Prelude["void"](Control_Monad_Eff.functorEff)(function __do() {
                                    var _75 = Prelude[">>="](Control_Monad_Eff.bindEff)(newLine)(Control_Monad_JQuery.appendText("(disj"))();
                                    Control_Monad_JQuery.append(_75)(_442)();
                                    Data_Traversable["for"](Control_Monad_Eff.applicativeEff)(Data_Traversable.traversableArray)(_443.value0)(function (g_2) {
                                        return function __do() {
                                            var _73 = indented();
                                            var _72 = linkTo(_441)(renderSavingState(_437)(_439)(_438)(unwind(new Kanren_State.State(g_2, _439.value1, _439.value2, _439.value3))))();
                                            renderGoal(false)(_72)(g_2)();
                                            Control_Monad_JQuery.append(_72)(_73)();
                                            return Control_Monad_JQuery.append(_73)(_442)();
                                        };
                                    })();
                                    var _74 = Prelude[">>="](Control_Monad_Eff.bindEff)(newLine)(Control_Monad_JQuery.appendText(")"))();
                                    return Control_Monad_JQuery.append(_74)(_442)();
                                });
                            };
                            if (_443 instanceof Kanren_Goal.Conj) {
                                return Prelude["void"](Control_Monad_Eff.functorEff)(function __do() {
                                    var _79 = Prelude[">>="](Control_Monad_Eff.bindEff)(newLine)(Control_Monad_JQuery.appendText("(conj"))();
                                    Control_Monad_JQuery.append(_79)(_442)();
                                    Data_Traversable["for"](Control_Monad_Eff.applicativeEff)(Data_Traversable.traversableArray)(inContext(_443.value0))(function (_435) {
                                        return function __do() {
                                            var _77 = indented();
                                            var _76 = linkTo(_441)(renderSavingState(_437)(_439)(_438)(unwind(new Kanren_State.State(_435.value0, _439.value1, _439.value2, Prelude["++"](Data_Array.semigroupArray)(_435.value1)(_439.value3)))))();
                                            renderGoal(false)(_76)(_435.value0)();
                                            Control_Monad_JQuery.append(_76)(_77)();
                                            return Control_Monad_JQuery.append(_77)(_442)();
                                        };
                                    })();
                                    var _78 = Prelude[">>="](Control_Monad_Eff.bindEff)(newLine)(Control_Monad_JQuery.appendText(")"))();
                                    return Control_Monad_JQuery.append(_78)(_442)();
                                });
                            };
                            throw new Error("Failed pattern match");
                        };
                    };
                };
                return Prelude["void"](Control_Monad_Eff.functorEff)(function __do() {
                    hideEditor();
                    var _90 = Control_Monad_Eff_Ref.readRef(_438)();
                    Prelude[">>="](Control_Monad_Eff.bindEff)(Control_Monad_JQuery.select("#undoButton"))(Control_Monad_JQuery.css({
                        display: Data_Array["null"](_90) ? "none" : "block"
                    }))();
                    Prelude[">>="](Control_Monad_Eff.bindEff)(Control_Monad_JQuery.select("#goal .lines"))(Control_Monad_JQuery.remove)();
                    var _89 = Prelude[">>="](Control_Monad_Eff.bindEff)(Control_Monad_JQuery.create("<div>"))(Control_Monad_JQuery.addClass("lines"))();
                    renderGoal(true)(_89)(_439.value0)();
                    Prelude[">>="](Control_Monad_Eff.bindEff)(Control_Monad_JQuery.select("#goal"))(Control_Monad_JQuery.append(_89))();
                    Prelude[">>="](Control_Monad_Eff.bindEff)(Control_Monad_JQuery.select("#stack tbody tr"))(Control_Monad_JQuery.remove)();
                    var _88 = Control_Monad_JQuery.select("#stack tbody")();
                    Data_Traversable["for"](Control_Monad_Eff.applicativeEff)(Data_Traversable.traversableArray)(_439.value3)(function (g$prime) {
                        return Prelude["void"](Control_Monad_Eff.functorEff)(function __do() {
                            var _82 = Control_Monad_JQuery.create("<tr>")();
                            var _81 = Control_Monad_JQuery.create("<td>")();
                            var _80 = Prelude[">>="](Control_Monad_Eff.bindEff)(Control_Monad_JQuery.create("<pre>"))(Control_Monad_JQuery.appendText(renderShortGoal(g$prime)))();
                            Control_Monad_JQuery.append(_80)(_81)();
                            Control_Monad_JQuery.append(_81)(_82)();
                            return Control_Monad_JQuery.append(_82)(_88)();
                        });
                    })();
                    Prelude[">>="](Control_Monad_Eff.bindEff)(Control_Monad_JQuery.select("#subst tbody tr"))(Control_Monad_JQuery.remove)();
                    var _87 = Control_Monad_JQuery.select("#subst tbody")();
                    return Data_Traversable["for"](Control_Monad_Eff.applicativeEff)(Data_Traversable.traversableArray)(Data_Array.sortBy(Data_Function.on(Prelude.compare(Kanren_Var.ordVar))(Data_Tuple.fst))(_439.value1))(function (_436) {
                        return function __do() {
                            var _86 = Control_Monad_JQuery.create("<tr>")();
                            var _85 = Prelude[">>="](Control_Monad_Eff.bindEff)(Control_Monad_JQuery.create("<td>"))(Control_Monad_JQuery.appendText("#" + Prelude.show(Prelude.showNumber)(_436.value0)))();
                            var _84 = Prelude[">>="](Control_Monad_Eff.bindEff)(Control_Monad_JQuery.create("<pre>"))(Control_Monad_JQuery.appendText(renderTerm(Kanren_Subst.walk(_439.value1)(_436.value1))))();
                            var _83 = Prelude[">>="](Control_Monad_Eff.bindEff)(Control_Monad_JQuery.create("<td>"))(Control_Monad_JQuery.append(_84))();
                            Control_Monad_JQuery.append(_85)(_86)();
                            Control_Monad_JQuery.append(_83)(_86)();
                            return Control_Monad_JQuery.append(_86)(_87)();
                        };
                    })();
                });
            };
        };
    };
    var $$eval = function (definesRef) {
        return function (history) {
            return function __do() {
                var _62 = Prelude[">>="](Control_Monad_Eff.bindEff)(Control_Monad_JQuery.select("#code"))(Control_Monad_JQuery.getValue)();
                var _61 = Prelude[">>="](Control_Monad_Eff.bindEff)(Control_Monad_JQuery.select("#defines"))(Control_Monad_JQuery.getValue)();
                return (function () {
                    var _745 = Prelude["<*>"](Data_Either.applyEither)(Prelude["<$>"](Data_Either.functorEither)(Data_Tuple.Tuple.create)(Data_Foreign_Class.read(Data_Foreign_Class.stringIsForeign)(_62)))(Data_Foreign_Class.read(Data_Foreign_Class.stringIsForeign)(_61));
                    if (_745 instanceof Data_Either.Left) {
                        return showError(Prelude.show(Data_Foreign.showForeignError)(_745.value0));
                    };
                    if (_745 instanceof Data_Either.Right) {
                        var _747 = Prelude["<*>"](Data_Either.applyEither)(Prelude["<$>"](Data_Either.functorEither)(Data_Tuple.Tuple.create)(Kanren_Parser.parseGoal(_745.value0.value0)))(Kanren_Parser.parseDefines(_745.value0.value1));
                        if (_747 instanceof Data_Either.Left) {
                            return showError(_747.value0);
                        };
                        if (_747 instanceof Data_Either.Right) {
                            return function __do() {
                                Control_Monad_Eff_Ref.writeRef(history)([  ])();
                                Control_Monad_Eff_Ref.writeRef(definesRef)(new Data_Maybe.Just(_747.value0.value1))();
                                return render(definesRef)(history)(new Kanren_State.State(_747.value0.value0, [  ], Kanren_Var.zero, [  ]))();
                            };
                        };
                        throw new Error("Failed pattern match");
                    };
                    throw new Error("Failed pattern match");
                })()();
            };
        };
    };
    return {
        "eval": $$eval, 
        hideEditor: hideEditor, 
        render: render, 
        renderSavingState: renderSavingState, 
        showEditor: showEditor, 
        showError: showError
    };
})();
var PS = PS || {};
PS.Main = (function () {
    "use strict";
    var Prelude = PS.Prelude;
    var Control_Monad_Eff = PS.Control_Monad_Eff;
    var Control_Monad_JQuery = PS.Control_Monad_JQuery;
    var Control_Monad_Eff_Ref = PS.Control_Monad_Eff_Ref;
    var Data_Maybe = PS.Data_Maybe;
    var Kanren_Render = PS.Kanren_Render;
    var withoutDefault = function (_453) {
        return function (_454) {
            return function (_455) {
                return function __do() {
                    _453();
                    return Control_Monad_JQuery.preventDefault(_454)();
                };
            };
        };
    };
    var main = function __do() {
        var _93 = Control_Monad_Eff_Ref.newRef([  ])();
        var _92 = Control_Monad_Eff_Ref.newRef(Data_Maybe.Nothing.value)();
        Prelude[">>="](Control_Monad_Eff.bindEff)(Control_Monad_JQuery.select("#editButton"))(Control_Monad_JQuery.on("click")(withoutDefault(Kanren_Render.showEditor)))();
        Prelude[">>="](Control_Monad_Eff.bindEff)(Control_Monad_JQuery.select("#evalButton"))(Control_Monad_JQuery.on("click")(withoutDefault(Kanren_Render["eval"](_92)(_93))))();
        return Prelude[">>="](Control_Monad_Eff.bindEff)(Control_Monad_JQuery.select("#undoButton"))(Control_Monad_JQuery.on("click")(withoutDefault(function __do() {
            var _91 = Control_Monad_Eff_Ref.readRef(_93)();
            return (function () {
                if (_91.length === 0) {
                    return Prelude["return"](Control_Monad_Eff.monadEff)(Prelude.unit);
                };
                if (_91.length >= 1) {
                    var _763 = _91.slice(1);
                    return function __do() {
                        Control_Monad_Eff_Ref.writeRef(_93)(_763)();
                        return Kanren_Render.render(_92)(_93)(_91[0])();
                    };
                };
                throw new Error("Failed pattern match");
            })()();
        })))();
    };
    return {
        main: main, 
        withoutDefault: withoutDefault
    };
})();
